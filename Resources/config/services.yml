services:

    sonata.admin.bd.activity:
        class: BrauneDigital\ActivityBundle\Admin\ActivityAdmin
        tags:
            - { name: sonata.admin, manager_type: orm, group: "Activity", label: "Activities" }
        arguments:
            - ~
            - BrauneDigital\ActivityBundle\Entity\Stream\Activity
            - BrauneDigitalActivityBundle:ActivityCrud
        calls:
            - [ setTranslationDomain, [ApplicationAppBundle]]

    bd_activity.entityaudit.manager:
        class: BrauneDigital\ActivityBundle\Services\AuditManager
        arguments: [@simplethings_entityaudit.config]

    bd_activity.refresh_stream:
        class: BrauneDigital\ActivityBundle\Services\StreamRefresh
        arguments: [@doctrine.orm.entity_manager, @service_container]

    bd_activity.entityaudit.reader:
        class:  BrauneDigital\ActivityBundle\Services\AuditReader
        factory: [@bd_activity.entityaudit.manager, createAuditReader]
        arguments: [@doctrine.orm.default_entity_manager]

    bd_activity.activity_builder:
        class:  BrauneDigital\ActivityBundle\Services\ActivityBuilder
        arguments: [@service_container]
        tags:
            - { name: kernel.event_listener, event: kernel.terminate, method: onKernelTerminate, priority: -1}

    bd_activity.doctrine_subscriber:
        class: BrauneDigital\ActivityBundle\EventListener\DoctrineSubscriber
        arguments: ['@bd_activity.activity_builder', '%doctrine_subscribing%']
        tags:
            - { name: doctrine.event_subscriber, priority: -1}